<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>조카모바일보안</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content="보안어플"/>
    <link href="https://cdn.jsdelivr.net/combine/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css,npm/pickerjs@1.2.1/dist/picker.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/combine/npm/pickerjs@1.2.1/dist/picker.min.js,npm/easytimer.js@4.3.0/dist/easytimer.min.js"></script>

    <!-- 주소창 등의 웹 브라우저 UI를 표시하지 않기 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- 상태 바의 스타일을 지정 -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- 홈 화면에서 표시되는 앱 이름을 지정 -->
    <meta name="apple-mobile-web-app-title" content="JOCA 모바일보안">
    <!-- 홈 화면에서 표시되는 앱 아이콘을 지정 -->
    <link rel="apple-touch-icon" href="icons/icon-152x152.png">

    <style>
      .header {
        background-color:#1583C6;
      }
      .nav {
        display: flex;
        justify-content: space-between;
        padding: 10px 20px;
      }
      .title {
        font-weight: 900;
        font-size: 30px;
        padding: 5px 15px;
        color: #fff;
      }
      .content {
        background-color: #fff;
        padding: 50px 0 20px 0;
        text-align: center;

      }
      .spinner {
        width: 280px;
        padding-top: 40px;
      }

      .info {
        display: flex;
        justify-content: startS;
        padding: 10px 0 0 10px;
        text-align: left;
      }
      .info-text {
        padding: 30px 0 0 10px;
        font-weight: 700;
        line-height: 0.5;
        color: #535154;
      }
      .clock {
        font-weight: 600;
        color: #fff;
        background-color: #04455C;
        padding : 5px 0;
        text-align: center;
      }

      .checkout-btn {
        background-color: #036C8D;
        color: #fff;
        text-align: center;
        padding: 30px 0;
        font-weight: 900;
      }

    </style>
  </head>
  <body style="background-color: #036C8D;">
    <header class="header">       
      <div class="nav">
      <img src="icon/menu.png">
      <img src="icon/refresh.png">
      </div>
      <div class="title">보호정책</div>
    </header>
    <main role="main">
      <div class="content">
        <img src="icon/logo.png" style="width: 180px;">
        <img src="icon/spinner.gif" class="spinner">
        <div class="info">
          <img src="icon/apple.png" style="object-fit: contain;">
          <div class="info-text">
            <p>개발 퇴실정책</p>
            <p style="font-weight: 800; color:#AD080D;">단말기를 안전하게 보호합니다</p>
          </div>
        </div>
      </div>

      <div class="clock">
        <p id="clock">clock</p>
      </div>

      <div class="checkout-btn">
        <h5>퇴실신청</h5>
      </div>

    </main>
    <script>
        var Target = document.getElementById("clock");
        function addZero(n) {
          return n < 10 ? '0' + n : n;
        }
        function clock() {
            var time = new Date();
            var year =  time.getFullYear().toString()
            var month = addZero(time.getMonth() + 1);
            var date =  addZero(time.getDate());
            var day = time.getDay();
            var week = ['일', '월', '화', '수', '목', '금', '토'];

            var hours = time.getHours();
            var minutes = time.getMinutes();
            var seconds = time.getSeconds();

            Target.innerText = 
            `${year}-${month}-${date} ` +
            `${hours < 10 ? `0${hours}` : hours}:${minutes < 10 ? `0${minutes}` : minutes}:${seconds < 10 ? `0${seconds}` : seconds}`;
                
        }

        clock();
        setInterval(clock, 1000); // 1초마다 실행
      const timePicker = document.querySelector('.time-picker');
      const values = document.querySelector('.values');
      const btnGroup1 = document.querySelector('#btn-group-1');
      const setBtn = document.querySelector('#set-btn');
      const startBtn = document.querySelector('#start-btn');
      const btnGroup2 = document.querySelector('#btn-group-2');
      const cancelBtn = document.querySelector('#cancel-btn');
      const pauseBtn = document.querySelector('#pause-btn');
      const resumeBtn = document.querySelector('#resume-btn');
      const ongoingStatus = document.querySelector('#ongoing-status');
      const completedStatus = document.querySelector('#completed-status');

      // 시간 설정 다이얼로그 생성
      new Picker(timePicker, {
        format: 'HH:mm:ss', // 시:분:초
        text: {
          title: '시간을 설정하세요',
          confirm: '확인',
          cancel: '취소'
        },
      });

      // 타이머 생성
      const timer = new easytimer.Timer();

      // 타이머 이벤트 리스너 등록
      timer.addEventListener('secondsUpdated', () => {
        values.textContent = timer.getTimeValues().toString();
      });
      timer.addEventListener('started', () => {
        values.textContent = timer.getTimeValues().toString();
      });
      timer.addEventListener('reset', () => {
        values.textContent = timer.getTimeValues().toString();
      });
      timer.addEventListener('targetAchieved', () => {
        values.textContent = '완료!'; // 카운트다운 완료

        ongoingStatus.style.display = 'none';
        completedStatus.style.display = 'block';
        btnGroup2.style.display = 'none';
        btnGroup1.style.display = 'block';
      });

      // 버튼 이벤트 리스너 등록
      /**
       * ['시간 설정' 버튼]
       *   경우1. 초기 화면에서
       *   경우2. 취소 후
       *   경우3. 완료 후
       */
      setBtn.addEventListener('click', () => {
        if (completedStatus.style.display === 'block') {
          values.style.display = 'none';
          timePicker.style.display = 'block';
          completedStatus.style.display = 'none';
        }

        timePicker.click();
      });
      /**
       * [시작 버튼]
       *   경우1. 초기 화면에서
       *   경우2. 취소 후
       *   경우3. 완료 후
       */
      startBtn.addEventListener('click', () => {
        timer.start({countdown: true, startValues: {seconds: toSeconds(timePicker.value)}});

        if (completedStatus.style.display === 'block') {
          completedStatus.style.display = 'none';
        } else {
          timePicker.style.display = 'none';
          values.style.display = 'block';
        }
        ongoingStatus.style.display = 'block';
        btnGroup1.style.display = 'none';
        btnGroup2.style.display = 'block';
      });
      // 취소 버튼
      cancelBtn.addEventListener('click', () => {
        // '일시 정지 > 취소 > 시작'인 경우
        if (timer.isPaused()) {
          resumeBtn.style.display = 'none';
          pauseBtn.style.display = 'inline-block';
        }

        timer.reset();
        timer.stop();

        values.style.display = 'none';
        timePicker.style.display = 'block';
        ongoingStatus.style.display = 'none';
        btnGroup2.style.display = 'none';
        btnGroup1.style.display = 'block';
      });
      // '일시 정지' 버튼
      pauseBtn.addEventListener('click', () => {
        timer.pause();

        ongoingStatus.style.display = 'none';
        pauseBtn.style.display = 'none';
        resumeBtn.style.display = 'inline-block';
      });
      // 재개 버튼
      resumeBtn.addEventListener('click', () => {
        timer.start();

        ongoingStatus.style.display = 'block';
        resumeBtn.style.display = 'none';
        pauseBtn.style.display = 'inline-block';
      });

      // '시:분:초'를 초로 계산하고, 그 결과값을 반환한다.
      function toSeconds(hhmmss) {
        const arr = hhmmss.split(':');
        return (+arr[0]) * 60 * 60 + (+arr[1]) * 60 + (+arr[2]);
      }
    </script>
  </body>
</html>